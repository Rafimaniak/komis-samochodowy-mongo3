<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Lista Us≈Çug Serwisowych</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöó</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<div th:replace="~{fragments/navbar :: main-nav}"></div>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-tools me-2"></i>Lista Us≈Çug Serwisowych</h1>
        <div>
            <a th:href="@{/serwis/raport}" class="btn btn-info me-2">
                <i class="fas fa-chart-bar"></i> Raport
            </a>
            <a th:href="@{/serwis/dodaj}" class="btn btn-success">
                <i class="fas fa-plus"></i> Dodaj Us≈Çugƒô
            </a>
        </div>
    </div>

    <div th:if="${serwisy.empty}" class="alert alert-info text-center">
        <i class="fas fa-info-circle fa-2x mb-3"></i><br>
        Brak us≈Çug serwisowych w systemie.
    </div>

    <div th:if="${!serwisy.empty}" class="table-responsive">
        <table class="table table-striped table-bordered table-hover">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Samoch√≥d</th>
                <th>Pracownik</th>
                <th>Opis Us≈Çugi</th>
                <th>Koszt</th>
                <th>Data Serwisu</th>
                <th>Akcje</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="s : ${serwisy}">
                <td th:text="${s.id}"></td>
                <td>
                    <span th:if="${samochodyMap != null && samochodyMap.containsKey(s.samochodId)}">
                        <strong th:text="${samochodyMap[s.samochodId].marka + ' ' + samochodyMap[s.samochodId].model}"></strong>
                        <br><small class="text-muted" th:text="'ID: ' + ${s.samochodId}"></small>
                    </span>
                    <span th:unless="${samochodyMap != null && samochodyMap.containsKey(s.samochodId)}">
                        <span class="text-muted">ID: </span><span th:text="${s.samochodId}"></span>
                    </span>
                </td>
                <td>
                    <span th:if="${pracownicyMap != null && pracownicyMap.containsKey(s.pracownikId)}"
                          th:text="${pracownicyMap[s.pracownikId].imie + ' ' + pracownicyMap[s.pracownikId].nazwisko}">
                    </span>
                    <span th:unless="${pracownicyMap != null && pracownicyMap.containsKey(s.pracownikId)}">
                        <span class="text-muted">ID: </span><span th:text="${s.pracownikId}"></span>
                    </span>
                </td>
                <td>
                    <span th:if="${#strings.length(s.opisUslugi) > 50}"
                          th:text="${#strings.substring(s.opisUslugi, 0, 50) + '...'}"></span>
                    <span th:if="${#strings.length(s.opisUslugi) <= 50}"
                          th:text="${s.opisUslugi}"></span>
                </td>
                <td>
                    <span th:if="${s.koszt != null}">
                        <strong class="text-success"
                                th:text="${#numbers.formatDecimal(s.koszt, 0, 2, 'POINT') + ' z≈Ç'}"></strong>
                    </span>
                    <span th:if="${s.koszt == null}" class="text-muted">-</span>
                </td>
                <td th:text="${#temporals.format(s.dataSerwisu, 'dd.MM.yyyy')}"></td>
                <td>
                    <div class="btn-group btn-group-sm" role="group">
                        <a th:href="@{'/serwis/edytuj/' + ${s.id}}"
                           class="btn btn-outline-primary" title="Edytuj">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a th:href="@{'/serwis/usun/' + ${s.id}}"
                           class="btn btn-outline-danger" title="Usu≈Ñ"
                           onclick="return confirm('Czy na pewno chcesz usunƒÖƒá tƒô us≈Çugƒô serwisowƒÖ?')">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="mt-3">
        <a href="/" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Powr√≥t do strony g≈Ç√≥wnej
        </a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>